<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Daily WOD — One-Page Scheduler</title>
  <style>
    :root {
      --bg: #0f1115;
      --card: #151922;
      --ink: #e8eaf0;
      --muted: #aab0c0;
      --accent: #61dafb;
      --good: #79ff97;
      --warn: #ffd866;
      --bad: #ff6e6e;
      --code: #1c2230;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; padding: 24px;
      background: var(--bg);
      color: var(--ink);
      font: 16px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
    }
    h1, h2, h3 { margin: 0 0 8px; line-height: 1.15; }
    h1 { font-size: 28px; }
    h2 { font-size: 20px; color: var(--muted); font-weight: 600; }
    h3 { font-size: 16px; color: var(--muted); font-weight: 600; }
    .wrap {
      max-width: 900px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
    }
    .card {
      background: var(--card);
      border: 1px solid #222937;
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 4px 18px rgba(0,0,0,0.25);
    }
    .row { display: flex; gap: 12px; flex-wrap: wrap; align-items: center; }
    .controls .row > * { flex: 0 0 auto; }
    button, select, input[type="date"] {
      background: #111723;
      color: var(--ink);
      border: 1px solid #2a3345;
      border-radius: 8px;
      padding: 10px 12px;
      cursor: pointer;
      font: inherit;
    }
    button:hover { border-color: var(--accent); }
    code, pre {
      background: var(--code);
      border: 1px solid #2a3345;
      border-radius: 8px;
      padding: 6px 8px;
      color: var(--ink);
    }
    .meta { color: var(--muted); font-size: 14px; }
    ul { margin: 8px 0 0 18px; }
    li { margin: 4px 0; }
    .pill {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid #2a3345;
      background: #0d1320;
      color: var(--muted);
      font-size: 12px;
      margin-right: 6px;
    }
    .typeA { border-color: #355a3a; color: #9de1af; }
    .typeB { border-color: #5a4d35; color: #ead18d; }
    .typeC { border-color: #5a3544; color: #f1a1b1; }
    details summary { cursor: pointer; user-select: none; }
    .muted { color: var(--muted); }
    .grid2 { display: grid; grid-template-columns: 1fr; gap: 12px; }
    @media (min-width: 800px) {
      .grid2 { grid-template-columns: 1fr 1fr; }
    }
    .footer { text-align: center; color: var(--muted); font-size: 12px; padding: 8px; }
    .notice { background: #1a2030; border-left: 4px solid var(--accent); padding: 10px 12px; border-radius: 8px; }
    .bench { color: var(--accent); font-weight: 600; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Daily WOD</h1>
      <div class="meta" id="todayStr"></div>
      <div class="row controls" style="margin-top:8px;">
        <div class="row">
          <button id="prevBtn" aria-label="Previous day">◀ Prev</button>
          <button id="nextBtn" aria-label="Next day">Next ▶</button>
          <button id="todayBtn" aria-label="Jump to today">Today</button>
        </div>
        <div class="row">
          <label class="muted" for="dayPicker">Day of Year:</label>
          <input id="dayPicker" type="number" min="1" max="365" value="1" />
          <button id="goBtn">Go</button>
        </div>
        <div class="row">
          <button id="copyLinkBtn" title="Copy link to this day">Copy Link</button>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="row" style="justify-content:space-between;align-items:center">
        <h2 id="wodTitle">Workout</h2>
        <div>
          <span class="pill" id="typePill"></span>
          <span class="pill" id="timeDomain"></span>
        </div>
      </div>
      <div id="wodBody"></div>
      <div class="meta" id="wodNotes" style="margin-top:8px;"></div>
    </div>

    <div class="card grid2">
      <div>
        <h3>Warm-Up (pick one)</h3>
        <div id="warmups"></div>
      </div>
      <div>
        <h3>Scaling & Loads</h3>
        <div id="scaling"></div>
      </div>
    </div>

    <div class="card">
      <details>
        <summary><strong>Browse Benchmarks / Named WODs</strong></summary>
        <div id="benchList" style="margin-top:8px;"></div>
      </details>
    </div>

    <div class="footer">One-file app. No backend. Built for KB 53/35, DB 50s, rower, running, box (20/24/32), pull-up bar, jump rope.</div>
  </div>

<script>
// --------- Utilities ---------
function mulberry32(a) {
  return function() {
    let t = a += 0x6D2B79F5;
    t = Math.imul(t ^ (t >>> 15), t | 1);
    t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
    return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
  }
}
function choice(rng, arr) { return arr[Math.floor(rng()*arr.length)] }
function shuffle(rng, arr) {
  const a = arr.slice();
  for (let i=a.length-1; i>0; i--) {
    const j = Math.floor(rng()*(i+1));
    [a[i],a[j]] = [a[j],a[i]];
  }
  return a;
}

// Day-of-year helpers
function dayOfYear(d) {
  const start = new Date(Date.UTC(d.getFullYear(),0,1));
  const oneDay = 24*60*60*1000;
  const diff = (Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()) - start);
  return Math.floor(diff/oneDay) + 1;
}
function fmtDate(d) {
  return d.toLocaleDateString(undefined, { weekday:'long', year:'numeric', month:'long', day:'numeric' });
}

// --------- Equipment / Defaults ---------
const LOADS = {
  db: { heavy: "2×50 lb", mod: "2×35 lb", light: "2×20 lb" },
  kb: { heavy: "53 lb", mod: "35 lb", light: "26 lb" },
  box: { std: "24\"", alt: "20\"" }
};

// --------- Warm-ups ---------
const WARMUPS = [
  {
    name: "General 8-min Flow",
    body: [
      "2 rounds (easy pace):",
      "• 30s jump rope (single-unders)",
      "• 10 air squats",
      "• 10 scap pull-ups or ring rows",
      "• 10 push-ups (hands elevated if needed)",
      "• 5 inchworms to plank + 5 hollow rocks"
    ]
  },
  {
    name: "Run / Row Prime (10 min)",
    body: [
      "Row or Run, building effort each 2 min: easy → moderate → brisk → easy",
      "Then 2 rounds: 8 KB swings (light), 6 lunges/leg, 5 kip swings or beat swings"
    ]
  },
  {
    name: "Shoulders & Hips (9 min)",
    body: [
      "3 rounds:",
      "• 10 PVC/rope pass-throughs",
      "• 10 glute bridges",
      "• 10 KB deadlifts (light)",
      "• 8 DB push press (light)",
      "• 20s active hang (or ring row hold)"
    ]
  },
  {
    name: "Engine On (7 min)",
    body: [
      "EMOM 7:",
      "1) 30s jump rope + 5 burpees",
      "2) 10 goblet squats (light) + 10 sit-ups"
    ]
  },
  {
    name: "Core & Kip (8 min)",
    body: [
      "2 rounds: 8 hollow rocks, 8 arch rocks, 20s hang, 8 knee raises, 6 strict pull-ups (band OK)"
    ]
  }
];

// --------- Named / Benchmark Bank (adapted to available gear) ---------
const BENCH = [
  {
    title: "Fran (DB)",
    type: "For Time",
    time: "Sprint (≤7)",
    body: [
      "21-15-9 reps:",
      `• DB Thrusters — ${LOADS.db.heavy}`,
      "• Pull-ups"
    ],
    notes: "Classic. Cap 7 min. Scale to ring rows or banded; reduce DB load to keep sets crisp."
  },
  {
    title: "Annie",
    type: "For Time",
    time: "7–12",
    body: [
      "50-40-30-20-10:",
      "• Double-unders (×2 singles if needed)",
      "• Sit-ups"
    ],
    notes: "OG core + rope tester."
  },
  {
    title: "Cindy",
    type: "AMRAP 20",
    time: "20",
    body: [
      "• 5 Pull-ups",
      "• 10 Push-ups",
      "• 15 Air Squats"
    ],
    notes: "Benchmark gymnastics engine."
  },
  {
    title: "Barbara (Half)",
    type: "For Time (5 rounds)",
    time: "Long 25–35",
    body: [
      "5 rounds:",
      "• 10 Pull-ups",
      "• 20 Push-ups",
      "• 30 Sit-ups",
      "• 40 Air Squats",
      "Rest 1 min between rounds"
    ],
    notes: "Half-volume version; full Barbara rests 3 min."
  },
  {
    title: "Helen",
    type: "For Time (3 rds)",
    time: "9–15",
    body: [
      "3 rounds:",
      "• 400m Run",
      `• 21 KB Swings — ${LOADS.kb.heavy}`,
      "• 12 Pull-ups"
    ],
    notes: "Grip + engine."
  },
  {
    title: "Murph (Partitioned)",
    type: "For Time",
    time: "45–65",
    body: [
      "• 1 mile Run",
      "• 100 Pull-ups",
      "• 200 Push-ups",
      "• 300 Air Squats",
      "• 1 mile Run",
      "(Partition calisthenics as 20 rounds of 5/10/15)"
    ],
    notes: "No vest required. Partition as needed; cap ~60 min."
  },
  {
    title: "Fight Gone Bad (Home)",
    type: "For Reps (3 rds)",
    time: "17",
    body: [
      "1 min each, 3 rds, 1 min rest between rounds:",
      `• DB Push Press — ${LOADS.db.mod}`,
      `• Box Jumps — ${LOADS.box.std}`,
      "• Row (calories)",
      `• KB Swings — ${LOADS.kb.mod}`,
      "• Burpees"
    ],
    notes: "Total reps is your score."
  },
  {
    title: "DT (DB)",
    type: "For Time (5 rds)",
    time: "7–15",
    body: [
      "5 rounds:",
      `• 12 DB Deadlifts — ${LOADS.db.heavy}`,
      `• 9 DB Hang Power Cleans — ${LOADS.db.heavy}`,
      `• 6 DB Push Jerks — ${LOADS.db.heavy}`,
      "(*Use two dumbbells)"
    ],
    notes: "Barbell classic, dumbbell style. Break early to manage grip."
  },
  {
    title: "Isabel (DB Snatch)",
    type: "For Time",
    time: "5–10",
    body: [
      `• 30 Alternating DB Snatches — ${LOADS.db.heavy}`
    ],
    notes: "Quick singles ok; keep back flat."
  },
  {
    title: "Grace (DB G2O)",
    type: "For Time",
    time: "3–8",
    body: [
      `• 30 DB Ground-to-Overheads — ${LOADS.db.heavy} (2x DB or fast singles alternating)`
    ],
    notes: "Barbell clean & jerk classic adapted."
  },
  {
    title: "Diane (DB/HSPU scale)",
    type: "For Time",
    time: "Sprint (≤9)",
    body: [
      "21-15-9:",
      `• DB Deadlifts — ${LOADS.db.heavy}`,
      "• Handstand Push-ups (or pike push-ups)"
    ],
    notes: "Hinge + press. Keep midline tight."
  },
  {
    title: "Eva (Scaled)",
    type: "For Time (5 rds)",
    time: "Long 35–50",
    body: [
      "5 rounds:",
      "• 800m Run",
      `• 30 KB Swings — ${LOADS.kb.heavy}`,
      "• 30 Pull-ups"
    ],
    notes: "Scale volume to 3 rounds if needed."
  },
  {
    title: "Chelsea (EMOM 30)",
    type: "EMOM 30",
    time: "30",
    body: [
      "Every minute for 30 min:",
      "• 5 Pull-ups, 10 Push-ups, 15 Air Squats",
      "(*Scale to EMOM 20 or reduce reps to stay unbroken ~first 10 min)"
    ],
    notes: "Pacing + gymnastics stamina."
  },
  {
    title: "Open 17.1 / 21.2 (DB)",
    type: "For Time",
    time: "10–20",
    body: [
      "10-20-30-40-50 reps:",
      `• Alternating DB Snatches — ${LOADS.db.heavy}`,
      `• Burpee Box Jump-Overs — ${LOADS.box.std}`
    ],
    notes: "Step up allowed. Cap ~20 min."
  },
  {
    title: "Open 21.1 (Home)",
    type: "For Time",
    time: "15–25",
    body: [
      "10-30-60-90-150:",
      "• Line-facing Burpees (or regular burpees)",
      "with",
      "• 10-30-60-90-150 Double-unders (scale to singles x2)"
    ],
    notes: "Wall walks replaced with burpees for home setup."
  },
  {
    title: "Open 22.1 (Home)",
    type: "AMRAP 15",
    time: "15",
    body: [
      "• 3 Wall Walks (or inchworm walk-ups)",
      `• 12 Alternating DB Snatches — ${LOADS.db.mod}`,
      `• 15 Box Jump-Overs — ${LOADS.box.std}`
    ],
    notes: "Steady cadence. Keep shoulders happy."
  },
  {
    title: "Kelly (Home)",
    type: "For Time (5 rds)",
    time: "Long 25–40",
    body: [
      "5 rounds:",
      "• 400m Run",
      `• 30 Box Jumps — ${LOADS.box.std}`,
      `• 30 DB Thrusters — ${LOADS.db.light}`
    ],
    notes: "Wall ball subbed with DB thrusters."
  },
  {
    title: "The Chief (DB)",
    type: "AMRAP 5×3 min",
    time: "19",
    body: [
      "5 × 3-min AMRAPs, rest 1 min between:",
      `• 3 DB Power Cleans — ${LOADS.db.heavy}`,
      "• 6 Push-ups",
      "• 9 Air Squats",
      "Pick up where you left off each round."
    ],
    notes: "Barbell replaced with DBs."
  },
  {
    title: "Tabata This (Home)",
    type: "For Total Reps",
    time: "24",
    body: [
      "Tabata (8x20s on/10s off) each, 1 min rest between movements:",
      "• Row (calories)",
      `• DB Thrusters — ${LOADS.db.light}`,
      "• Pull-ups (or ring rows)",
      "• Sit-ups",
      "• Double-unders (or singles)"
    ],
    notes: "Score = sum of lowest rounds or total—choose before start."
  }
];

// Spread the named WODs across the year deterministically
function namedSchedule() {
  const slots = new Map();
  const spacing = 7; // every 7 days
  let idx = 0;
  for (let day = 7; day <= 365 && idx < BENCH.length; day += spacing) {
    slots.set(day, idx++ % BENCH.length);
  }
  // Anchors:
  slots.set(145, findBench("Murph (Partitioned)"));   // ~May 25
  slots.set(1, findBench("Cindy"));
  slots.set(200, findBench("Fran (DB)"));
  slots.set(300, findBench("Open 17.1 / 21.2 (DB)"));
  return slots;
}
function findBench(title) {
  return BENCH.findIndex(b => b.title === title);
}
const NAMED_SLOTS = namedSchedule();

// --------- Generator building blocks ---------
const MONO = [
  "Run 200m","Run 400m","Run 600m","Run 800m","Run 1,000m",
  "Row 250m","Row 500m","Row 750m","Row 1,000m","Row 1,500m",
  "50 Double-unders","75 Double-unders","100 Double-unders","150 Single-unders","200 Single-unders"
];
const GYM = [
  "10 Pull-ups","8 Chest-to-bar (or 12 Pull-ups)","10 Toes-to-bar (or 15 V-ups)",
  "15 Push-ups","20 Sit-ups","15 Burpees","20 Air Squats","10 Pike Push-ups"
];
const DB = [
  `12 DB Thrusters — ${LOADS.db.mod}`,
  `10 DB Push Press — ${LOADS.db.heavy}`,
  `12 DB Front Squats — ${LOADS.db.heavy}`,
  `10 DB Power Cleans — ${LOADS.db.heavy}`,
  `12 DB Deadlifts — ${LOADS.db.heavy}`,
  `10 Alternating DB Snatches — ${LOADS.db.heavy}`
];
const KB = [
  `15 KB Swings — ${LOADS.kb.heavy}`,
  `20 KB Swings — ${LOADS.kb.mod}`,
  `14 KB Goblet Squats — ${LOADS.kb.heavy}`,
  `10 KB Clean & Press (alt) — ${LOADS.kb.heavy}`
];
const BOX = [
  `15 Box Jumps — ${LOADS.box.std}`,
  `12 Burpee Box Jump-Overs — ${LOADS.box.std}`
];

// Time domains
const TD = {
  sprint: "Sprint (≤9)",
  short: "10–15",
  med: "15–20",
  long: "20–30+"
};

// Day type cycle: A (Triplet AMRAP), B (EMOM), C (Chipper For Time)
function buildGenerated(day, rng) {
  const typeIdx = (day - 1) % 3;
  if (typeIdx === 0) {
    // Type A: 12- or 15-min AMRAP triplet
    const mono = choice(rng, MONO);
    const gym = choice(rng, GYM);
    const loadBlock = rng() < 0.5 ? choice(rng, DB) : choice(rng, KB.concat(BOX));
    const mins = rng() < 0.5 ? 12 : 15;
    return {
      title: `AMRAP ${mins} — Triplet`,
      type: "AMRAP",
      time: mins.toString(),
      pill: "typeA",
      body: [
        `As many rounds as possible in ${mins} minutes:`,
        `• ${mono}`,
        `• ${loadBlock}`,
        `• ${gym}`
      ],
      notes: "Move steady. Aim for consistent round splits."
    };
  } else if (typeIdx === 1) {
    // Type B: 18 or 20-min EMOM (3 stations)
    const s1 = choice(rng, DB.concat(KB));
    const s2 = choice(rng, GYM.concat(BOX));
    const s3 = choice(rng, MONO);
    const mins = rng() < 0.5 ? 18 : 20;
    return {
      title: `EMOM ${mins} — Rotate 3`,
      type: "EMOM",
      time: mins.toString(),
      pill: "typeB",
      body: [
        `Every minute on the minute for ${mins} min, rotate:`,
        `1) ${s1}`,
        `2) ${s2}`,
        `3) ${s3}`,
        "Pick reps to finish each minute in ~40–45s."
      ],
      notes: "EMOM pacing. Keep quality and hit the windows."
    };
  } else {
    // Type C: For Time chipper
    const parts = shuffle(rng, [
      choice(rng, MONO),
      choice(rng, DB.concat(KB)),
      choice(rng, GYM),
      choice(rng, BOX)
    ]);
    const add = rng() < 0.6 ? [choice(rng, MONO)] : [];
    const seq = parts.concat(add);
    return {
      title: "Chipper — For Time",
      type: "For Time",
      time: TD.med,
      pill: "typeC",
      body: seq.map((x,i)=> (i===0?"Complete for time:":"• ")+x),
      notes: "Break early. Smooth is fast."
    };
  }
}

// Build full-year schedule deterministically with named WODs slotted in
function buildYear(seed=1337) {
  const out = new Array(365);
  const rng = mulberry32(seed);
  for (let day=1; day<=365; day++) {
    if (NAMED_SLOTS.has(day)) {
      const idx = NAMED_SLOTS.get(day);
      const b = BENCH[idx];
      out[day-1] = {
        title: b.title,
        type: b.type,
        time: b.time,
        pill: "typeA",
        body: b.body,
        notes: b.notes,
        named: true
      };
    } else {
      out[day-1] = buildGenerated(day, rng);
    }
  }
  return out;
}

const YEAR = buildYear();

// --------- UI glue ---------
const elTitle = document.getElementById("wodTitle");
const elBody = document.getElementById("wodBody");
const elNotes = document.getElementById("wodNotes");
const elTodayStr = document.getElementById("todayStr");
const elTypePill = document.getElementById("typePill");
const elTD = document.getElementById("timeDomain");
const elWarmups = document.getElementById("warmups");
const elScaling = document.getElementById("scaling");
const elBenchList = document.getElementById("benchList");

function renderWarmups() {
  elWarmups.innerHTML = WARMUPS.map(w => {
    return `<div class="notice" style="margin-bottom:8px">
      <div><strong>${w.name}</strong></div>
      <div class="muted">${w.body.map(l=> (l.startsWith("•")||l.match(/rounds|EMOM/))?l: l).join("<br>")}</div>
    </div>`;
  }).join("");
}

function renderScaling() {
  elScaling.innerHTML = `
    <div class="notice" style="margin-bottom:8px">
      <div><strong>Default Loads</strong></div>
      <div class="muted">DB: ${LOADS.db.heavy} (mod: ${LOADS.db.mod}), KB: ${LOADS.kb.heavy} (mod: ${LOADS.kb.mod}), Box: ${LOADS.box.std} (alt: ${LOADS.box.alt})</div>
    </div>
    <ul>
      <li><strong>Pull-ups:</strong> banded, jumping, or ring rows (maintain set quality).</li>
      <li><strong>HSPU:</strong> pike push-ups, feet on box, or DB strict press (light).</li>
      <li><strong>Double-unders:</strong> 2:1 singles or time-capped attempts.</li>
      <li><strong>Row/Run:</strong> sub 1:1 distance/time if terrain or space is limited.</li>
      <li><strong>DB/KB:</strong> drop loads to keep sets unbroken early; move well.</li>
    </ul>
  `;
}

function renderBenchList() {
  elBenchList.innerHTML = BENCH.map((b, i) => {
    return `<div class="notice" style="margin-bottom:8px">
      <div><span class="bench">#${i+1} — ${b.title}</span> <span class="pill typeA">${b.type}</span> <span class="pill">${b.time}</span></div>
      <div style="margin-top:6px">${b.body.map(l=> (l.startsWith("•")||l.match(/rounds|For Time|AMRAP|EMOM|rest/))?l:`• ${l}`).join("<br>")}</div>
      <div class="meta" style="margin-top:6px">${b.notes}</div>
    </div>`;
  }).join("");
}

function setTypePill(w) {
  let txt = w.type;
  let cls = w.pill || "typeA";
  elTypePill.textContent = txt;
  elTypePill.className = `pill ${cls}`;
  elTD.textContent = w.time || "";
}

function renderDay(day) {
  const idx = day - 1;
  const w = YEAR[idx];
  elTitle.textContent = w.named ? `${w.title} (Benchmark)` : w.title;
  setTypePill(w);
  const lines = w.body;
  let html = "<ul>";
  for (let i=0; i<lines.length; i++) {
    const L = lines[i];
    html += `<li>${L}</li>`;
  }
  html += "</ul>";
  elBody.innerHTML = html;
  elNotes.textContent = w.notes || "";
  document.getElementById("dayPicker").value = day;
  const url = new URL(window.location);
  url.searchParams.set("day", String(day));
  window.history.replaceState({}, "", url);
}

function getInitialDay() {
  const url = new URL(window.location);
  const qp = url.searchParams.get("day");
  if (qp) {
    const n = Math.max(1, Math.min(365, parseInt(qp,10)||1));
    return n;
  }
  const d = new Date();
  return dayOfYear(d);
}

function init() {
  const d = new Date();
  document.getElementById("todayStr").textContent = fmtDate(d);
  renderWarmups();
  renderScaling();
  renderBenchList();
  const startDay = getInitialDay();
  renderDay(startDay);

  document.getElementById("prevBtn").onclick = () => {
    const cur = parseInt(document.getElementById("dayPicker").value,10);
    renderDay(cur <= 1 ? 365 : cur - 1);
  };
  document.getElementById("nextBtn").onclick = () => {
    const cur = parseInt(document.getElementById("dayPicker").value,10);
    renderDay(cur >= 365 ? 1 : cur + 1);
  };
  document.getElementById("todayBtn").onclick = () => {
    renderDay(dayOfYear(new Date()));
  };
  document.getElementById("goBtn").onclick = () => {
    const n = Math.max(1, Math.min(365, parseInt(document.getElementById("dayPicker").value,10)||1));
    renderDay(n);
  };
  document.getElementById("copyLinkBtn").onclick = async () => {
    try {
      await navigator.clipboard.writeText(window.location.href);
      alert("Link copied.");
    } catch(e) {
      alert("Copy failed. Select URL and copy manually.");
    }
  };
}

document.addEventListener("DOMContentLoaded", init);
</script>
</body>
</html>
